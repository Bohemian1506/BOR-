# 🚀 {{FEATURE_NAME}}実装依頼

**生成日時**: {{DATE}}  
**プロジェクト**: {{PROJECT_INFO}}

## 🎯 実装タスク
BattleOfRunteqプロジェクトで「{{FEATURE_NAME}}」を実装してください。

## 📋 詳細実装手順

### 1. 一覧表示機能の基盤構築
- **対象コントローラー強化**: 既存または新規コントローラーの拡張
- **indexアクション実装**:
  - ページネーション機能（Kaminari gem使用）
  - ソート機能（日付、名前、人気度など）
  - 検索・絞り込み機能
  - レスポンス形式対応（HTML、JSON）

### 2. 検索・絞り込み機能
- **検索パラメータ定義**:
  - キーワード検索（名前、説明文）
  - カテゴリ絞り込み
  - 日付範囲絞り込み
  - ステータス絞り込み
  - 地域絞り込み（該当する場合）
- **検索実装**:
  - PostgreSQLの全文検索機能活用
  - スコープメソッドでの絞り込みロジック
  - 複数条件の組み合わせ対応

### 3. ソート機能実装
- **ソートオプション**:
  - 作成日時（新しい順・古い順）
  - 更新日時
  - 名前（あいうえお順・逆順）
  - 人気度（参加者数、いいね数など）
  - カスタム順序（優先度、ステータス）
- **URLパラメータ対応**: 
  - `?sort=created_at&direction=desc`
  - ソート状態の保持・共有可能

### 4. ページネーション実装
- **Kaminari gem導入**: 
```ruby
# Gemfile
gem 'kaminari'
```
- **設定**:
  - 1ページあたりの表示件数設定
  - ページネーションUI（Bootstrap対応）
  - SEO対応（canonical URL、meta tags）
  - 無限スクロール対応（JavaScript）

### 5. レスポンシブ対応表示形式
- **表示形式切り替え**:
  - カード形式（デフォルト）
  - リスト形式
  - グリッド形式
  - テーブル形式（管理者向け）
- **モバイル最適化**:
  - スマートフォン専用レイアウト
  - タッチ操作最適化
  - 読み込み速度最適化

### 6. フィルタリングUI
- **検索フォーム実装**:
  - 複数条件の同時指定
  - 入力補完機能
  - 保存済み検索条件
  - クリアボタン
- **視覚的フィルター**:
  - タグ形式でのカテゴリ選択
  - 日付ピッカー
  - 範囲指定スライダー

### 7. パフォーマンス最適化
- **効率的なクエリ**:
  - N+1クエリ問題の解決（includes、joins使用）
  - インデックス最適化
  - カウントクエリの効率化
- **キャッシュ戦略**:
  - ページキャッシュ
  - フラグメントキャッシュ
  - カウンタキャッシュ

### 8. ビューファイル作成
- **Bootstrap 5.2対応レスポンシブデザイン**
- **app/views/[resource]/**:
  - `index.html.erb` (メイン一覧ページ)
  - `_search_form.html.erb` (検索フォームパーシャル)
  - `_item_card.html.erb` (アイテムカードパーシャル)
  - `_item_list.html.erb` (リスト表示パーシャル)
  - `_pagination.html.erb` (ページネーションパーシャル)
  - `_sort_options.html.erb` (ソートオプションパーシャル)

## 🔧 技術要件

### 基本要件
- **Rails 8 + PostgreSQL + Bootstrap 5.2対応**
- **MVCパターン準拠、初学者理解しやすい実装**
- **日本語コメント必須**（コードの意図と動作を説明）
- **Strong Parameters使用**（セキュリティ考慮）
- **RSpec テスト実装必須**

### 一覧表示特有の要件
- **パフォーマンス**: 大量データでも高速表示
- **ユーザビリティ**: 直感的な検索・絞り込み操作
- **SEO対応**: 検索エンジンフレンドリーなURL構造
- **アクセシビリティ**: スクリーンリーダー対応
- **モバイル対応**: スマートフォンでの使いやすさ

### パフォーマンス要件
- **データベース最適化**: 適切なインデックス設計
- **メモリ効率**: 大量データ処理での省メモリ実装
- **読み込み速度**: 初期表示の高速化
- **スケーラビリティ**: 将来の成長を見越した設計

## 📁 対象ファイル

### 新規作成・修正
- `app/controllers/[resource]_controller.rb` (indexアクション強化)
- `app/models/[resource].rb` (検索・ソートスコープ追加)
- `app/views/[resource]/index.html.erb` (一覧ページ)
- `app/views/[resource]/_search_form.html.erb`
- `app/views/[resource]/_item_card.html.erb`
- `app/helpers/[resource]_helper.rb` (ヘルパーメソッド)
- `app/assets/javascripts/search.js` (検索UI用JavaScript)
- `spec/requests/[resource]_spec.rb` (一覧機能テスト)

### 設定ファイル
- `config/initializers/kaminari_config.rb` (ページネーション設定)
- `db/migrate/[timestamp]_add_search_indexes.rb` (検索用インデックス)

## 📝 実装時の注意点

### パフォーマンス考慮
1. **N+1クエリ対策**: includes、joinsの適切な使用
2. **インデックス設計**: 検索・ソート条件に応じた最適化
3. **ページネーション**: offset使用時の大きなページ番号での性能劣化対策
4. **カウント処理**: 大量データでのcount処理最適化

### ユーザビリティ考慮
1. **検索結果**: 「見つからない」場合の適切なメッセージ
2. **ローディング**: 検索・フィルタリング中の視覚的フィードバック
3. **URL設計**: ブックマーク・共有しやすいURL
4. **ブラウザ履歴**: 戻るボタンでの適切な状態復元

### モバイル対応
1. **タッチ操作**: 指で操作しやすいボタンサイズ
2. **画面サイズ**: 小さな画面での情報整理
3. **読み込み速度**: モバイル回線での最適化
4. **操作性**: スワイプ、ピンチ操作への対応

## ✅ 完了基準

### 機能面
- [ ] 基本的な一覧表示が正常に動作
- [ ] 検索・絞り込み機能が動作
- [ ] ソート機能が正常に動作
- [ ] ページネーションが機能
- [ ] レスポンシブデザインが動作

### パフォーマンス面
- [ ] 大量データでも高速表示（1000件以上で検証）
- [ ] N+1クエリ問題が解決済み
- [ ] 適切なインデックスが設定済み
- [ ] メモリ使用量が適切

### UI/UX面
- [ ] Bootstrap UIが適切に表示される
- [ ] モバイルデバイスで使いやすい
- [ ] 検索結果が分かりやすい
- [ ] エラーメッセージが適切

### 品質面
- [ ] すべてのRSpecテストがパス
- [ ] セキュリティチェック完了
- [ ] アクセシビリティチェック完了
- [ ] 初学者向けコメント完備

## 💡 実装のヒント

### よくある課題と対策
1. **検索パフォーマンス**: PostgreSQLの全文検索、GINインデックス活用
2. **複雑な絞り込み**: ransack gemの活用検討
3. **無限スクロール**: Intersection Observer APIの使用
4. **SEO**: meta tagsの適切な設定

### おすすめGem
- **kaminari**: ページネーション
- **ransack**: 複雑な検索機能
- **pg_search**: PostgreSQL全文検索
- **meta-tags**: SEO対応

### パフォーマンス最適化技術
- **データベース**: 複合インデックス、パーシャルインデックス
- **フロントエンド**: 遅延読み込み、仮想スクロール
- **キャッシュ**: Redis活用、HTTP キャッシュ
- **CDN**: 静的ファイルの配信最適化

### 拡張可能性の考慮
- お気に入り機能
- 保存済み検索
- 検索履歴
- レコメンデーション機能
- エクスポート機能

この実装指示に基づき、段階的に一覧表示機能を実装してください。特に、パフォーマンスとユーザビリティのバランスを考慮し、十分なテストを行ってください。